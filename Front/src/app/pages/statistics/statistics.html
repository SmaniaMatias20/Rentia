<div class="max-w-screen bg-black relative border sm:h-full">

    @if (loading) {
    <div class="fixed inset-0 flex justify-center items-center bg-black bg-opacity-50 z-50">
        <app-spinner></app-spinner>
    </div>
    }

    <!-- Botón volver -->
    <div class="
  absolute top-4 right-4 left-4 sm:left-auto
  flex justify-end
  z-20
">
        <button class="
    flex items-center justify-center gap-1
    py-2 px-4
    w-full sm:w-auto
    whitespace-nowrap
    rounded-lg bg-blue-600 hover:bg-blue-700
    text-white font-semibold transition cursor-pointer
  " (click)="goToHome()">
            <span class="material-icons">arrow_back</span>
            Volver al menú
        </button>
    </div>


    <!-- Filtro Mes-Año -->
    <div class="max-w-screen mx-auto px-4 mt-20 sm:mt-0 flex justify-start">
        <div class="
    flex flex-col sm:flex-row
    items-stretch sm:items-center
    gap-3
    bg-gray-900 p-3 rounded-lg border border-gray-700
    w-full sm:w-auto
  ">

            <label class="text-white text-sm font-semibold whitespace-nowrap">
                Filtrar por período:
            </label>

            <input type="month" [(ngModel)]="selectedMonthYear" class="
        w-full sm:w-auto
        bg-gray-800 text-white px-3 py-2
        rounded-lg border border-gray-600
        focus:outline-none
      " />

            <!-- Aplicar -->
            <button (click)="applyMonthYearFilter()" [disabled]="!selectedMonthYear" class="
        w-full sm:w-auto
        bg-blue-600 hover:bg-blue-700
        text-white text-sm font-semibold
        px-4 py-2 rounded-lg transition
        disabled:opacity-50 disabled:cursor-not-allowed
        cursor-pointer whitespace-nowrap
      ">
                Aplicar
            </button>

            <!-- Limpiar -->
            <button (click)="clearMonthYearFilter()" [disabled]="!selectedMonthYear" class="
        w-full sm:w-auto
        bg-gray-600 hover:bg-gray-700
        text-white text-sm font-semibold
        px-4 py-2 rounded-lg transition
        disabled:opacity-50 disabled:cursor-not-allowed
        cursor-pointer whitespace-nowrap
      ">
                Limpiar
            </button>

        </div>
    </div>

    <hr class="border-gray-700 my-10 mx-5">

    <h2 class="text-2xl font-bold text-center text-gray-800 dark:text-gray-100 mb-6">
        Estadisticas de {{ visibleMonthYear}}
    </h2>

    <div class="max-w-screen mx-auto mt-10 px-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">

        <!-- Cantidad de pagos -->
        <app-card-statistic icon="receipt_long" title="Pagos" [value]="quantityOfPaymentsByUser"
            description="Cantidad de pagos" iconColor="text-green-500" descriptionColor="text-green-400">
        </app-card-statistic>

        <!-- Ingresos mensuales -->
        <app-card-statistic icon="attach_money" title="Alquileres"
            [value]="monthlyRentIncome | currency:'ARS':'symbol':'1.0-0'" description="Ingreso mensual"
            iconColor="text-emerald-500" descriptionColor="text-emerald-400">
        </app-card-statistic>

        <!-- Costos de luz -->
        <app-card-statistic icon="flash_on" title="Luz"
            [value]="monthlyElectricityIncome | currency:'ARS':'symbol':'1.0-0'" description="Costo mensual"
            iconColor="text-yellow-500" descriptionColor="text-yellow-400">
        </app-card-statistic>

        <!-- Costos de gas -->
        <app-card-statistic icon="local_gas_station" title="Gas"
            [value]="monthlyGasIncome | currency:'ARS':'symbol':'1.0-0'" description="Costo mensual"
            iconColor="text-red-500" descriptionColor="text-red-400">
        </app-card-statistic>

        <!-- Costos de agua -->
        <app-card-statistic icon="water" title="Agua" [value]=" monthlyWaterIncome | currency:'ARS':'symbol':'1.0-0'"
            description="Costo mensual" iconColor="text-blue-500" descriptionColor="text-blue-400">
        </app-card-statistic>

        <!-- Costos de ABL/expensas -->
        <app-card-statistic icon="attach_money" title="ABL/Expensas"
            [value]=" monthlyHoaIncome | currency:'ARS':'symbol':'1.0-0'" description="Costo mensual"
            iconColor="text-red-500" descriptionColor="text-red-400">
        </app-card-statistic>

    </div>

    <hr class="border-gray-700 my-10 mx-5">

    <h2 class="text-2xl font-bold text-center text-gray-800 dark:text-gray-100 mb-6">
        Estadisticas Generales
    </h2>

    <!-- Cards de métricas -->
    <div class="max-w-screen mx-auto mt-10 px-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">


        <!-- Total propiedades -->
        <app-card-statistic icon="home" title="Propiedades" [value]="quantityOfPropertiesByUser"
            description="Total registradas" iconColor="text-blue-500" descriptionColor="text-blue-400">
        </app-card-statistic>

        <!-- Ocupadas -->
        <app-card-statistic icon="check_circle" title="Ocupadas" [value]="quantityOfPropertiesWithTenantByUser"
            [description]="percentageOfPropertiesWithTenantByUser + '% de ocupación'" iconColor="text-green-500"
            descriptionColor="text-green-400">
        </app-card-statistic>

        <!-- Desocupadas -->
        <app-card-statistic icon="remove_circle" title="Desocupadas" [value]="quantityOfPropertiesWithoutTenantByUser"
            [description]="percentageOfPropertiesWithoutTenantByUser + '% disponibles'" iconColor="text-red-500"
            descriptionColor="text-red-400">
        </app-card-statistic>

        <!-- Inquilinos -->
        <app-card-statistic icon="groups" title="Inquilinos" [value]="quantityOfTenantsByUser"
            description="Total de inquilinos" iconColor="text-purple-500" descriptionColor="text-purple-400">
        </app-card-statistic>

        <!-- Alquiler más alto -->
        <app-card-statistic icon="arrow_upward" title="Máximo" [value]=" highestRent | currency:'ARS':'symbol':'1.0-0'"
            description="Alquiler más alto" iconColor="text-purple-500" descriptionColor="text-purple-400">
        </app-card-statistic>

        <!-- Alquiler más bajo -->
        <app-card-statistic icon="arrow_downward" title="Mínimo" [value]="lowestRent | currency:'ARS':'symbol':'1.0-0'"
            description="Alquiler más bajo" iconColor="text-indigo-500" descriptionColor="text-indigo-400">
        </app-card-statistic>

        <!-- Contratos activos -->
        <app-card-statistic icon="article" title="Contratos en curso" [value]="quantityOfActiveContractsByUser"
            description="Están en fecha" iconColor="text-green-500" descriptionColor="text-green-400">
        </app-card-statistic>

        <!-- Contratos proximos a vencerse -->
        <app-card-statistic icon="article" title="Contratos a vencerse" [value]="quantityOfContractsToVenceByUser"
            description="A tres meses de finalizar" iconColor="text-yellow-500" descriptionColor="text-yellow-400">
        </app-card-statistic>

        <!-- Contratos vencidos -->
        <app-card-statistic icon="article" title="Contratos vencidos" [value]="quantityOfContractsVencedByUser"
            description="Han finalizado" iconColor="text-red-500" descriptionColor="text-red-400">
        </app-card-statistic>

        <!-- Contratos que todavia no han comenzado -->
        <app-card-statistic icon="article" title="Contratos pendientes" [value]="quantityOfContractsPendingByUser"
            description="Todavía no han comenzado" iconColor="text-blue-500" descriptionColor="text-blue-400">
        </app-card-statistic>

    </div>



    <!-- Toast -->
    <app-toast #toast></app-toast>
</div>